Набор скриптов и инструкций для миграции виртуальных машин в SDN Sprut.

О том что такое SDN, какие функциональные и нефункциональные премимущества между Neutron и Sprut смотрите [полное руководство](docs/complete_guide_to_migrating_to_SDN_SPRUT.md).

Миграция с neutron на sprut процесс, требующий дополнительные действия с точки зрения сетевой инфраструктуры. 

## Базовый кейс миграции IaaS

1. Отправить в техподдержку запрос на добавление сети sprut в проект в облаке. В обращении необходимо указать айди проекта/проектов куда нужно добавить сеть sprut. [Контакты техподдержки](https://cloud.vk.com/docs/ru/intro/start/support/support-info).
1. Подготовить рабочее место администратора (ВМ с ОС Linux) с установленными компонентами OpenStack CLI, файл конфигурации отправлен в source и вызовы CLI проходят без ошибок. [Инструкция по установке](https://cloud.vk.com/docs/tools-for-using-services/cli/openstack-cli).
1. Перенести на рабочее место администратора перенесен скрипт автоматизации, либо выполнить на нём ```git clone https://github.com/vk-cs/neutron-2-sprut.git``` для копирования всего репозитория со всеми скриптами.
1. Подготовить сетевую инфраструктуру. [!WARNING] Новые сущности должны должны иметь в названии постфикс **-sprut**, чтобы названия аналогичных объектов на sprut и нейтроне не совпадали.
    1. Создать сети и подсети с аналогичными адресами, статическими маршрутами. 
    2. Создать аналогичные роутеры с аналогичными статическими маршрутами и подключить к ним новые сети.
    3. Создать секьюрити группы, для этого можно использовать [скрипт](copy-security-group.sh).
    4. Создать плавающие ip. Они могут иметь отличные от исходных адреса. В разработке находится возможность переноса адресов с нейтрона на спрут, требуется уточнить об этом перед выполнением миграции.
1. Подготовить список виртуальных машин для миграции, посмотреть количество сетевых подключений. Скрипт для миграции способен переносить вм только с одним сетевым подключением. Можно использовать команду openstack server list.
1. Подготовить файл со списком мигрируемых для [скрипта миграции](migrator-multiple.sh).
1. Выделить техническое окно, во время которого сервисы могут не работать. На время переключения виртуальная машина потеряет сетевую связность. На одну виртуальную машину уходит ~45 секунд. 
1. Запустить скрипт миграции.
1. Перезагрузить на виртуальных машинах dhclient.
1. При наличии, создать балансировщики нагрузки в сетях на sprut.
1. Проверить работу инфраструктуры и сервисов.